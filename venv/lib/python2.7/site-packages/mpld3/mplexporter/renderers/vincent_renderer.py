import warnings
from .base import Renderer
from ..exporter import Exporter


class VincentRenderer(Renderer***REMOVED***:
    def open_figure(self, fig, props***REMOVED***:
        self.chart = None
        self.figwidth = int(props['figwidth'***REMOVED*** * props['dpi'***REMOVED******REMOVED***
        self.figheight = int(props['figheight'***REMOVED*** * props['dpi'***REMOVED******REMOVED***

    def draw_line(self, data, coordinates, style, label, mplobj=None***REMOVED***:
        import vincent  # only import if VincentRenderer is used
        if coordinates != 'data':
            warnings.warn("Only data coordinates supported. Skipping this"***REMOVED***
        linedata = {'x': data[:, 0***REMOVED***,
                    'y': data[:, 1***REMOVED******REMOVED***
        line = vincent.Line(linedata, iter_idx='x',
                            width=self.figwidth, height=self.figheight***REMOVED***

        # TODO: respect the other style settings
        line.scales['color'***REMOVED***.range = [style['color'***REMOVED******REMOVED***

        if self.chart is None:
            self.chart = line
        else:
            warnings.warn("Multiple plot elements not yet supported"***REMOVED***

    def draw_markers(self, data, coordinates, style, label, mplobj=None***REMOVED***:
        import vincent  # only import if VincentRenderer is used
        if coordinates != 'data':
            warnings.warn("Only data coordinates supported. Skipping this"***REMOVED***
        markerdata = {'x': data[:, 0***REMOVED***,
                      'y': data[:, 1***REMOVED******REMOVED***
        markers = vincent.Scatter(markerdata, iter_idx='x',
                                  width=self.figwidth, height=self.figheight***REMOVED***

        # TODO: respect the other style settings
        markers.scales['color'***REMOVED***.range = [style['facecolor'***REMOVED******REMOVED***

        if self.chart is None:
            self.chart = markers
        else:
            warnings.warn("Multiple plot elements not yet supported"***REMOVED***


def fig_to_vincent(fig***REMOVED***:
    ***REMOVED***Convert a matplotlib figure to a vincent object***REMOVED***
    renderer = VincentRenderer(***REMOVED***
    exporter = Exporter(renderer***REMOVED***
    exporter.run(fig***REMOVED***
    return renderer.chart
