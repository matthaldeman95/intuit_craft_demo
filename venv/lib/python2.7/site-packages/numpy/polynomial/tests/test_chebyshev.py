***REMOVED***Tests for chebyshev module.

***REMOVED***
from __future__ import division, absolute_import, print_function

import numpy as np
import numpy.polynomial.chebyshev as cheb
from numpy.polynomial.polynomial import polyval
from numpy.testing import (
    TestCase, assert_almost_equal, assert_raises,
    assert_equal, assert_, run_module_suite***REMOVED***


def trim(x***REMOVED***:
    return cheb.chebtrim(x, tol=1e-6***REMOVED***

T0 = [1***REMOVED***
T1 = [0, 1***REMOVED***
T2 = [-1, 0, 2***REMOVED***
T3 = [0, -3, 0, 4***REMOVED***
T4 = [1, 0, -8, 0, 8***REMOVED***
T5 = [0, 5, 0, -20, 0, 16***REMOVED***
T6 = [-1, 0, 18, 0, -48, 0, 32***REMOVED***
T7 = [0, -7, 0, 56, 0, -112, 0, 64***REMOVED***
T8 = [1, 0, -32, 0, 160, 0, -256, 0, 128***REMOVED***
T9 = [0, 9, 0, -120, 0, 432, 0, -576, 0, 256***REMOVED***

Tlist = [T0, T1, T2, T3, T4, T5, T6, T7, T8, T9***REMOVED***


class TestPrivate(TestCase***REMOVED***:

    def test__cseries_to_zseries(self***REMOVED***:
        for i in range(5***REMOVED***:
            inp = np.array([2***REMOVED*** + [1***REMOVED****i, np.double***REMOVED***
            tgt = np.array([.5***REMOVED****i + [2***REMOVED*** + [.5***REMOVED****i, np.double***REMOVED***
            res = cheb._cseries_to_zseries(inp***REMOVED***
            assert_equal(res, tgt***REMOVED***

    def test__zseries_to_cseries(self***REMOVED***:
        for i in range(5***REMOVED***:
            inp = np.array([.5***REMOVED****i + [2***REMOVED*** + [.5***REMOVED****i, np.double***REMOVED***
            tgt = np.array([2***REMOVED*** + [1***REMOVED****i, np.double***REMOVED***
            res = cheb._zseries_to_cseries(inp***REMOVED***
            assert_equal(res, tgt***REMOVED***


class TestConstants(TestCase***REMOVED***:

    def test_chebdomain(self***REMOVED***:
        assert_equal(cheb.chebdomain, [-1, 1***REMOVED******REMOVED***

    def test_chebzero(self***REMOVED***:
        assert_equal(cheb.chebzero, [0***REMOVED******REMOVED***

    def test_chebone(self***REMOVED***:
        assert_equal(cheb.chebone, [1***REMOVED******REMOVED***

    def test_chebx(self***REMOVED***:
        assert_equal(cheb.chebx, [0, 1***REMOVED******REMOVED***


class TestArithmetic(TestCase***REMOVED***:

    def test_chebadd(self***REMOVED***:
        for i in range(5***REMOVED***:
            for j in range(5***REMOVED***:
                msg = "At i=%d, j=%d" % (i, j***REMOVED***
                tgt = np.zeros(max(i, j***REMOVED*** + 1***REMOVED***
                tgt[i***REMOVED*** += 1
                tgt[j***REMOVED*** += 1
                res = cheb.chebadd([0***REMOVED****i + [1***REMOVED***, [0***REMOVED****j + [1***REMOVED******REMOVED***
                assert_equal(trim(res***REMOVED***, trim(tgt***REMOVED***, err_msg=msg***REMOVED***

    def test_chebsub(self***REMOVED***:
        for i in range(5***REMOVED***:
            for j in range(5***REMOVED***:
                msg = "At i=%d, j=%d" % (i, j***REMOVED***
                tgt = np.zeros(max(i, j***REMOVED*** + 1***REMOVED***
                tgt[i***REMOVED*** += 1
                tgt[j***REMOVED*** -= 1
                res = cheb.chebsub([0***REMOVED****i + [1***REMOVED***, [0***REMOVED****j + [1***REMOVED******REMOVED***
                assert_equal(trim(res***REMOVED***, trim(tgt***REMOVED***, err_msg=msg***REMOVED***

    def test_chebmulx(self***REMOVED***:
        assert_equal(cheb.chebmulx([0***REMOVED******REMOVED***, [0***REMOVED******REMOVED***
        assert_equal(cheb.chebmulx([1***REMOVED******REMOVED***, [0, 1***REMOVED******REMOVED***
        for i in range(1, 5***REMOVED***:
            ser = [0***REMOVED****i + [1***REMOVED***
            tgt = [0***REMOVED****(i - 1***REMOVED*** + [.5, 0, .5***REMOVED***
            assert_equal(cheb.chebmulx(ser***REMOVED***, tgt***REMOVED***

    def test_chebmul(self***REMOVED***:
        for i in range(5***REMOVED***:
            for j in range(5***REMOVED***:
                msg = "At i=%d, j=%d" % (i, j***REMOVED***
                tgt = np.zeros(i + j + 1***REMOVED***
                tgt[i + j***REMOVED*** += .5
                tgt[abs(i - j***REMOVED******REMOVED*** += .5
                res = cheb.chebmul([0***REMOVED****i + [1***REMOVED***, [0***REMOVED****j + [1***REMOVED******REMOVED***
                assert_equal(trim(res***REMOVED***, trim(tgt***REMOVED***, err_msg=msg***REMOVED***

    def test_chebdiv(self***REMOVED***:
        for i in range(5***REMOVED***:
            for j in range(5***REMOVED***:
                msg = "At i=%d, j=%d" % (i, j***REMOVED***
                ci = [0***REMOVED****i + [1***REMOVED***
                cj = [0***REMOVED****j + [1***REMOVED***
                tgt = cheb.chebadd(ci, cj***REMOVED***
                quo, rem = cheb.chebdiv(tgt, ci***REMOVED***
                res = cheb.chebadd(cheb.chebmul(quo, ci***REMOVED***, rem***REMOVED***
                assert_equal(trim(res***REMOVED***, trim(tgt***REMOVED***, err_msg=msg***REMOVED***


class TestEvaluation(TestCase***REMOVED***:
    # coefficients of 1 + 2*x + 3*x**2
    c1d = np.array([2.5, 2., 1.5***REMOVED******REMOVED***
    c2d = np.einsum('i,j->ij', c1d, c1d***REMOVED***
    c3d = np.einsum('i,j,k->ijk', c1d, c1d, c1d***REMOVED***

    # some random values in [-1, 1***REMOVED***
    x = np.random.random((3, 5***REMOVED******REMOVED****2 - 1
    y = polyval(x, [1., 2., 3.***REMOVED******REMOVED***

    def test_chebval(self***REMOVED***:
        #check empty input
        assert_equal(cheb.chebval([***REMOVED***, [1***REMOVED******REMOVED***.size, 0***REMOVED***

        #check normal input***REMOVED***
        x = np.linspace(-1, 1***REMOVED***
        y = [polyval(x, c***REMOVED*** for c in Tlist***REMOVED***
        for i in range(10***REMOVED***:
            msg = "At i=%d" % i
            tgt = y[i***REMOVED***
            res = cheb.chebval(x, [0***REMOVED****i + [1***REMOVED******REMOVED***
            assert_almost_equal(res, tgt, err_msg=msg***REMOVED***

        #check that shape is preserved
        for i in range(3***REMOVED***:
            dims = [2***REMOVED****i
            x = np.zeros(dims***REMOVED***
            assert_equal(cheb.chebval(x, [1***REMOVED******REMOVED***.shape, dims***REMOVED***
            assert_equal(cheb.chebval(x, [1, 0***REMOVED******REMOVED***.shape, dims***REMOVED***
            assert_equal(cheb.chebval(x, [1, 0, 0***REMOVED******REMOVED***.shape, dims***REMOVED***

    def test_chebval2d(self***REMOVED***:
        x1, x2, x3 = self.x
        y1, y2, y3 = self.y

        #test exceptions
        assert_raises(ValueError, cheb.chebval2d, x1, x2[:2***REMOVED***, self.c2d***REMOVED***

        #test values
        tgt = y1*y2
        res = cheb.chebval2d(x1, x2, self.c2d***REMOVED***
        assert_almost_equal(res, tgt***REMOVED***

        #test shape
        z = np.ones((2, 3***REMOVED******REMOVED***
        res = cheb.chebval2d(z, z, self.c2d***REMOVED***
        assert_(res.shape == (2, 3***REMOVED******REMOVED***

    def test_chebval3d(self***REMOVED***:
        x1, x2, x3 = self.x
        y1, y2, y3 = self.y

        #test exceptions
        assert_raises(ValueError, cheb.chebval3d, x1, x2, x3[:2***REMOVED***, self.c3d***REMOVED***

        #test values
        tgt = y1*y2*y3
        res = cheb.chebval3d(x1, x2, x3, self.c3d***REMOVED***
        assert_almost_equal(res, tgt***REMOVED***

        #test shape
        z = np.ones((2, 3***REMOVED******REMOVED***
        res = cheb.chebval3d(z, z, z, self.c3d***REMOVED***
        assert_(res.shape == (2, 3***REMOVED******REMOVED***

    def test_chebgrid2d(self***REMOVED***:
        x1, x2, x3 = self.x
        y1, y2, y3 = self.y

        #test values
        tgt = np.einsum('i,j->ij', y1, y2***REMOVED***
        res = cheb.chebgrid2d(x1, x2, self.c2d***REMOVED***
        assert_almost_equal(res, tgt***REMOVED***

        #test shape
        z = np.ones((2, 3***REMOVED******REMOVED***
        res = cheb.chebgrid2d(z, z, self.c2d***REMOVED***
        assert_(res.shape == (2, 3***REMOVED****2***REMOVED***

    def test_chebgrid3d(self***REMOVED***:
        x1, x2, x3 = self.x
        y1, y2, y3 = self.y

        #test values
        tgt = np.einsum('i,j,k->ijk', y1, y2, y3***REMOVED***
        res = cheb.chebgrid3d(x1, x2, x3, self.c3d***REMOVED***
        assert_almost_equal(res, tgt***REMOVED***

        #test shape
        z = np.ones((2, 3***REMOVED******REMOVED***
        res = cheb.chebgrid3d(z, z, z, self.c3d***REMOVED***
        assert_(res.shape == (2, 3***REMOVED****3***REMOVED***


class TestIntegral(TestCase***REMOVED***:

    def test_chebint(self***REMOVED***:
        # check exceptions
        assert_raises(ValueError, cheb.chebint, [0***REMOVED***, .5***REMOVED***
        assert_raises(ValueError, cheb.chebint, [0***REMOVED***, -1***REMOVED***
        assert_raises(ValueError, cheb.chebint, [0***REMOVED***, 1, [0, 0***REMOVED******REMOVED***

        # test integration of zero polynomial
        for i in range(2, 5***REMOVED***:
            k = [0***REMOVED****(i - 2***REMOVED*** + [1***REMOVED***
            res = cheb.chebint([0***REMOVED***, m=i, k=k***REMOVED***
            assert_almost_equal(res, [0, 1***REMOVED******REMOVED***

        # check single integration with integration constant
        for i in range(5***REMOVED***:
            scl = i + 1
            pol = [0***REMOVED****i + [1***REMOVED***
            tgt = [i***REMOVED*** + [0***REMOVED****i + [1/scl***REMOVED***
            chebpol = cheb.poly2cheb(pol***REMOVED***
            chebint = cheb.chebint(chebpol, m=1, k=[i***REMOVED******REMOVED***
            res = cheb.cheb2poly(chebint***REMOVED***
            assert_almost_equal(trim(res***REMOVED***, trim(tgt***REMOVED******REMOVED***

        # check single integration with integration constant and lbnd
        for i in range(5***REMOVED***:
            scl = i + 1
            pol = [0***REMOVED****i + [1***REMOVED***
            chebpol = cheb.poly2cheb(pol***REMOVED***
            chebint = cheb.chebint(chebpol, m=1, k=[i***REMOVED***, lbnd=-1***REMOVED***
            assert_almost_equal(cheb.chebval(-1, chebint***REMOVED***, i***REMOVED***

        # check single integration with integration constant and scaling
        for i in range(5***REMOVED***:
            scl = i + 1
            pol = [0***REMOVED****i + [1***REMOVED***
            tgt = [i***REMOVED*** + [0***REMOVED****i + [2/scl***REMOVED***
            chebpol = cheb.poly2cheb(pol***REMOVED***
            chebint = cheb.chebint(chebpol, m=1, k=[i***REMOVED***, scl=2***REMOVED***
            res = cheb.cheb2poly(chebint***REMOVED***
            assert_almost_equal(trim(res***REMOVED***, trim(tgt***REMOVED******REMOVED***

        # check multiple integrations with default k
        for i in range(5***REMOVED***:
            for j in range(2, 5***REMOVED***:
                pol = [0***REMOVED****i + [1***REMOVED***
                tgt = pol[:***REMOVED***
                for k in range(j***REMOVED***:
                    tgt = cheb.chebint(tgt, m=1***REMOVED***
                res = cheb.chebint(pol, m=j***REMOVED***
                assert_almost_equal(trim(res***REMOVED***, trim(tgt***REMOVED******REMOVED***

        # check multiple integrations with defined k
        for i in range(5***REMOVED***:
            for j in range(2, 5***REMOVED***:
                pol = [0***REMOVED****i + [1***REMOVED***
                tgt = pol[:***REMOVED***
                for k in range(j***REMOVED***:
                    tgt = cheb.chebint(tgt, m=1, k=[k***REMOVED******REMOVED***
                res = cheb.chebint(pol, m=j, k=list(range(j***REMOVED******REMOVED******REMOVED***
                assert_almost_equal(trim(res***REMOVED***, trim(tgt***REMOVED******REMOVED***

        # check multiple integrations with lbnd
        for i in range(5***REMOVED***:
            for j in range(2, 5***REMOVED***:
                pol = [0***REMOVED****i + [1***REMOVED***
                tgt = pol[:***REMOVED***
                for k in range(j***REMOVED***:
                    tgt = cheb.chebint(tgt, m=1, k=[k***REMOVED***, lbnd=-1***REMOVED***
                res = cheb.chebint(pol, m=j, k=list(range(j***REMOVED******REMOVED***, lbnd=-1***REMOVED***
                assert_almost_equal(trim(res***REMOVED***, trim(tgt***REMOVED******REMOVED***

        # check multiple integrations with scaling
        for i in range(5***REMOVED***:
            for j in range(2, 5***REMOVED***:
                pol = [0***REMOVED****i + [1***REMOVED***
                tgt = pol[:***REMOVED***
                for k in range(j***REMOVED***:
                    tgt = cheb.chebint(tgt, m=1, k=[k***REMOVED***, scl=2***REMOVED***
                res = cheb.chebint(pol, m=j, k=list(range(j***REMOVED******REMOVED***, scl=2***REMOVED***
                assert_almost_equal(trim(res***REMOVED***, trim(tgt***REMOVED******REMOVED***

    def test_chebint_axis(self***REMOVED***:
        # check that axis keyword works
        c2d = np.random.random((3, 4***REMOVED******REMOVED***

        tgt = np.vstack([cheb.chebint(c***REMOVED*** for c in c2d.T***REMOVED******REMOVED***.T
        res = cheb.chebint(c2d, axis=0***REMOVED***
        assert_almost_equal(res, tgt***REMOVED***

        tgt = np.vstack([cheb.chebint(c***REMOVED*** for c in c2d***REMOVED******REMOVED***
        res = cheb.chebint(c2d, axis=1***REMOVED***
        assert_almost_equal(res, tgt***REMOVED***

        tgt = np.vstack([cheb.chebint(c, k=3***REMOVED*** for c in c2d***REMOVED******REMOVED***
        res = cheb.chebint(c2d, k=3, axis=1***REMOVED***
        assert_almost_equal(res, tgt***REMOVED***


class TestDerivative(TestCase***REMOVED***:

    def test_chebder(self***REMOVED***:
        # check exceptions
        assert_raises(ValueError, cheb.chebder, [0***REMOVED***, .5***REMOVED***
        assert_raises(ValueError, cheb.chebder, [0***REMOVED***, -1***REMOVED***

        # check that zeroth deriviative does nothing
        for i in range(5***REMOVED***:
            tgt = [0***REMOVED****i + [1***REMOVED***
            res = cheb.chebder(tgt, m=0***REMOVED***
            assert_equal(trim(res***REMOVED***, trim(tgt***REMOVED******REMOVED***

        # check that derivation is the inverse of integration
        for i in range(5***REMOVED***:
            for j in range(2, 5***REMOVED***:
                tgt = [0***REMOVED****i + [1***REMOVED***
                res = cheb.chebder(cheb.chebint(tgt, m=j***REMOVED***, m=j***REMOVED***
                assert_almost_equal(trim(res***REMOVED***, trim(tgt***REMOVED******REMOVED***

        # check derivation with scaling
        for i in range(5***REMOVED***:
            for j in range(2, 5***REMOVED***:
                tgt = [0***REMOVED****i + [1***REMOVED***
                res = cheb.chebder(cheb.chebint(tgt, m=j, scl=2***REMOVED***, m=j, scl=.5***REMOVED***
                assert_almost_equal(trim(res***REMOVED***, trim(tgt***REMOVED******REMOVED***

    def test_chebder_axis(self***REMOVED***:
        # check that axis keyword works
        c2d = np.random.random((3, 4***REMOVED******REMOVED***

        tgt = np.vstack([cheb.chebder(c***REMOVED*** for c in c2d.T***REMOVED******REMOVED***.T
        res = cheb.chebder(c2d, axis=0***REMOVED***
        assert_almost_equal(res, tgt***REMOVED***

        tgt = np.vstack([cheb.chebder(c***REMOVED*** for c in c2d***REMOVED******REMOVED***
        res = cheb.chebder(c2d, axis=1***REMOVED***
        assert_almost_equal(res, tgt***REMOVED***


class TestVander(TestCase***REMOVED***:
    # some random values in [-1, 1***REMOVED***
    x = np.random.random((3, 5***REMOVED******REMOVED****2 - 1

    def test_chebvander(self***REMOVED***:
        # check for 1d x
        x = np.arange(3***REMOVED***
        v = cheb.chebvander(x, 3***REMOVED***
        assert_(v.shape == (3, 4***REMOVED******REMOVED***
        for i in range(4***REMOVED***:
            coef = [0***REMOVED****i + [1***REMOVED***
            assert_almost_equal(v[..., i***REMOVED***, cheb.chebval(x, coef***REMOVED******REMOVED***

        # check for 2d x
        x = np.array([[1, 2***REMOVED***, [3, 4***REMOVED***, [5, 6***REMOVED******REMOVED******REMOVED***
        v = cheb.chebvander(x, 3***REMOVED***
        assert_(v.shape == (3, 2, 4***REMOVED******REMOVED***
        for i in range(4***REMOVED***:
            coef = [0***REMOVED****i + [1***REMOVED***
            assert_almost_equal(v[..., i***REMOVED***, cheb.chebval(x, coef***REMOVED******REMOVED***

    def test_chebvander2d(self***REMOVED***:
        # also tests chebval2d for non-square coefficient array
        x1, x2, x3 = self.x
        c = np.random.random((2, 3***REMOVED******REMOVED***
        van = cheb.chebvander2d(x1, x2, [1, 2***REMOVED******REMOVED***
        tgt = cheb.chebval2d(x1, x2, c***REMOVED***
        res = np.dot(van, c.flat***REMOVED***
        assert_almost_equal(res, tgt***REMOVED***

        # check shape
        van = cheb.chebvander2d([x1***REMOVED***, [x2***REMOVED***, [1, 2***REMOVED******REMOVED***
        assert_(van.shape == (1, 5, 6***REMOVED******REMOVED***

    def test_chebvander3d(self***REMOVED***:
        # also tests chebval3d for non-square coefficient array
        x1, x2, x3 = self.x
        c = np.random.random((2, 3, 4***REMOVED******REMOVED***
        van = cheb.chebvander3d(x1, x2, x3, [1, 2, 3***REMOVED******REMOVED***
        tgt = cheb.chebval3d(x1, x2, x3, c***REMOVED***
        res = np.dot(van, c.flat***REMOVED***
        assert_almost_equal(res, tgt***REMOVED***

        # check shape
        van = cheb.chebvander3d([x1***REMOVED***, [x2***REMOVED***, [x3***REMOVED***, [1, 2, 3***REMOVED******REMOVED***
        assert_(van.shape == (1, 5, 24***REMOVED******REMOVED***


class TestFitting(TestCase***REMOVED***:

    def test_chebfit(self***REMOVED***:
        def f(x***REMOVED***:
            return x*(x - 1***REMOVED****(x - 2***REMOVED***

        def f2(x***REMOVED***:
            return x**4 + x**2 + 1

        # Test exceptions
        assert_raises(ValueError, cheb.chebfit, [1***REMOVED***, [1***REMOVED***, -1***REMOVED***
        assert_raises(TypeError, cheb.chebfit, [[1***REMOVED******REMOVED***, [1***REMOVED***, 0***REMOVED***
        assert_raises(TypeError, cheb.chebfit, [***REMOVED***, [1***REMOVED***, 0***REMOVED***
        assert_raises(TypeError, cheb.chebfit, [1***REMOVED***, [[[1***REMOVED******REMOVED******REMOVED***, 0***REMOVED***
        assert_raises(TypeError, cheb.chebfit, [1, 2***REMOVED***, [1***REMOVED***, 0***REMOVED***
        assert_raises(TypeError, cheb.chebfit, [1***REMOVED***, [1, 2***REMOVED***, 0***REMOVED***
        assert_raises(TypeError, cheb.chebfit, [1***REMOVED***, [1***REMOVED***, 0, w=[[1***REMOVED******REMOVED******REMOVED***
        assert_raises(TypeError, cheb.chebfit, [1***REMOVED***, [1***REMOVED***, 0, w=[1, 1***REMOVED******REMOVED***
        assert_raises(ValueError, cheb.chebfit, [1***REMOVED***, [1***REMOVED***, [-1,***REMOVED******REMOVED***
        assert_raises(ValueError, cheb.chebfit, [1***REMOVED***, [1***REMOVED***, [2, -1, 6***REMOVED******REMOVED***
        assert_raises(TypeError, cheb.chebfit, [1***REMOVED***, [1***REMOVED***, [***REMOVED******REMOVED***

        # Test fit
        x = np.linspace(0, 2***REMOVED***
        y = f(x***REMOVED***
        #
        coef3 = cheb.chebfit(x, y, 3***REMOVED***
        assert_equal(len(coef3***REMOVED***, 4***REMOVED***
        assert_almost_equal(cheb.chebval(x, coef3***REMOVED***, y***REMOVED***
        coef3 = cheb.chebfit(x, y, [0, 1, 2, 3***REMOVED******REMOVED***
        assert_equal(len(coef3***REMOVED***, 4***REMOVED***
        assert_almost_equal(cheb.chebval(x, coef3***REMOVED***, y***REMOVED***
        #
        coef4 = cheb.chebfit(x, y, 4***REMOVED***
        assert_equal(len(coef4***REMOVED***, 5***REMOVED***
        assert_almost_equal(cheb.chebval(x, coef4***REMOVED***, y***REMOVED***
        coef4 = cheb.chebfit(x, y, [0, 1, 2, 3, 4***REMOVED******REMOVED***
        assert_equal(len(coef4***REMOVED***, 5***REMOVED***
        assert_almost_equal(cheb.chebval(x, coef4***REMOVED***, y***REMOVED***
        # check things still work if deg is not in strict increasing
        coef4 = cheb.chebfit(x, y, [2, 3, 4, 1, 0***REMOVED******REMOVED***
        assert_equal(len(coef4***REMOVED***, 5***REMOVED***
        assert_almost_equal(cheb.chebval(x, coef4***REMOVED***, y***REMOVED***
        #
        coef2d = cheb.chebfit(x, np.array([y, y***REMOVED******REMOVED***.T, 3***REMOVED***
        assert_almost_equal(coef2d, np.array([coef3, coef3***REMOVED******REMOVED***.T***REMOVED***
        coef2d = cheb.chebfit(x, np.array([y, y***REMOVED******REMOVED***.T, [0, 1, 2, 3***REMOVED******REMOVED***
        assert_almost_equal(coef2d, np.array([coef3, coef3***REMOVED******REMOVED***.T***REMOVED***
        # test weighting
        w = np.zeros_like(x***REMOVED***
        yw = y.copy(***REMOVED***
        w[1::2***REMOVED*** = 1
        y[0::2***REMOVED*** = 0
        wcoef3 = cheb.chebfit(x, yw, 3, w=w***REMOVED***
        assert_almost_equal(wcoef3, coef3***REMOVED***
        wcoef3 = cheb.chebfit(x, yw, [0, 1, 2, 3***REMOVED***, w=w***REMOVED***
        assert_almost_equal(wcoef3, coef3***REMOVED***
        #
        wcoef2d = cheb.chebfit(x, np.array([yw, yw***REMOVED******REMOVED***.T, 3, w=w***REMOVED***
        assert_almost_equal(wcoef2d, np.array([coef3, coef3***REMOVED******REMOVED***.T***REMOVED***
        wcoef2d = cheb.chebfit(x, np.array([yw, yw***REMOVED******REMOVED***.T, [0, 1, 2, 3***REMOVED***, w=w***REMOVED***
        assert_almost_equal(wcoef2d, np.array([coef3, coef3***REMOVED******REMOVED***.T***REMOVED***
        # test scaling with complex values x points whose square
        # is zero when summed.
        x = [1, 1j, -1, -1j***REMOVED***
        assert_almost_equal(cheb.chebfit(x, x, 1***REMOVED***, [0, 1***REMOVED******REMOVED***
        assert_almost_equal(cheb.chebfit(x, x, [0, 1***REMOVED******REMOVED***, [0, 1***REMOVED******REMOVED***
        # test fitting only even polynomials
        x = np.linspace(-1, 1***REMOVED***
        y = f2(x***REMOVED***
        coef1 = cheb.chebfit(x, y, 4***REMOVED***
        assert_almost_equal(cheb.chebval(x, coef1***REMOVED***, y***REMOVED***
        coef2 = cheb.chebfit(x, y, [0, 2, 4***REMOVED******REMOVED***
        assert_almost_equal(cheb.chebval(x, coef2***REMOVED***, y***REMOVED***
        assert_almost_equal(coef1, coef2***REMOVED***


class TestCompanion(TestCase***REMOVED***:

    def test_raises(self***REMOVED***:
        assert_raises(ValueError, cheb.chebcompanion, [***REMOVED******REMOVED***
        assert_raises(ValueError, cheb.chebcompanion, [1***REMOVED******REMOVED***

    def test_dimensions(self***REMOVED***:
        for i in range(1, 5***REMOVED***:
            coef = [0***REMOVED****i + [1***REMOVED***
            assert_(cheb.chebcompanion(coef***REMOVED***.shape == (i, i***REMOVED******REMOVED***

    def test_linear_root(self***REMOVED***:
        assert_(cheb.chebcompanion([1, 2***REMOVED******REMOVED***[0, 0***REMOVED*** == -.5***REMOVED***


class TestGauss(TestCase***REMOVED***:

    def test_100(self***REMOVED***:
        x, w = cheb.chebgauss(100***REMOVED***

        # test orthogonality. Note that the results need to be normalized,
        # otherwise the huge values that can arise from fast growing
        # functions like Laguerre can be very confusing.
        v = cheb.chebvander(x, 99***REMOVED***
        vv = np.dot(v.T * w, v***REMOVED***
        vd = 1/np.sqrt(vv.diagonal(***REMOVED******REMOVED***
        vv = vd[:, None***REMOVED*** * vv * vd
        assert_almost_equal(vv, np.eye(100***REMOVED******REMOVED***

        # check that the integral of 1 is correct
        tgt = np.pi
        assert_almost_equal(w.sum(***REMOVED***, tgt***REMOVED***


class TestMisc(TestCase***REMOVED***:

    def test_chebfromroots(self***REMOVED***:
        res = cheb.chebfromroots([***REMOVED******REMOVED***
        assert_almost_equal(trim(res***REMOVED***, [1***REMOVED******REMOVED***
        for i in range(1, 5***REMOVED***:
            roots = np.cos(np.linspace(-np.pi, 0, 2*i + 1***REMOVED***[1::2***REMOVED******REMOVED***
            tgt = [0***REMOVED****i + [1***REMOVED***
            res = cheb.chebfromroots(roots***REMOVED****2**(i-1***REMOVED***
            assert_almost_equal(trim(res***REMOVED***, trim(tgt***REMOVED******REMOVED***

    def test_chebroots(self***REMOVED***:
        assert_almost_equal(cheb.chebroots([1***REMOVED******REMOVED***, [***REMOVED******REMOVED***
        assert_almost_equal(cheb.chebroots([1, 2***REMOVED******REMOVED***, [-.5***REMOVED******REMOVED***
        for i in range(2, 5***REMOVED***:
            tgt = np.linspace(-1, 1, i***REMOVED***
            res = cheb.chebroots(cheb.chebfromroots(tgt***REMOVED******REMOVED***
            assert_almost_equal(trim(res***REMOVED***, trim(tgt***REMOVED******REMOVED***

    def test_chebtrim(self***REMOVED***:
        coef = [2, -1, 1, 0***REMOVED***

        # Test exceptions
        assert_raises(ValueError, cheb.chebtrim, coef, -1***REMOVED***

        # Test results
        assert_equal(cheb.chebtrim(coef***REMOVED***, coef[:-1***REMOVED******REMOVED***
        assert_equal(cheb.chebtrim(coef, 1***REMOVED***, coef[:-3***REMOVED******REMOVED***
        assert_equal(cheb.chebtrim(coef, 2***REMOVED***, [0***REMOVED******REMOVED***

    def test_chebline(self***REMOVED***:
        assert_equal(cheb.chebline(3, 4***REMOVED***, [3, 4***REMOVED******REMOVED***

    def test_cheb2poly(self***REMOVED***:
        for i in range(10***REMOVED***:
            assert_almost_equal(cheb.cheb2poly([0***REMOVED****i + [1***REMOVED******REMOVED***, Tlist[i***REMOVED******REMOVED***

    def test_poly2cheb(self***REMOVED***:
        for i in range(10***REMOVED***:
            assert_almost_equal(cheb.poly2cheb(Tlist[i***REMOVED******REMOVED***, [0***REMOVED****i + [1***REMOVED******REMOVED***

    def test_weight(self***REMOVED***:
        x = np.linspace(-1, 1, 11***REMOVED***[1:-1***REMOVED***
        tgt = 1./(np.sqrt(1 + x***REMOVED*** * np.sqrt(1 - x***REMOVED******REMOVED***
        res = cheb.chebweight(x***REMOVED***
        assert_almost_equal(res, tgt***REMOVED***

    def test_chebpts1(self***REMOVED***:
        #test exceptions
        assert_raises(ValueError, cheb.chebpts1, 1.5***REMOVED***
        assert_raises(ValueError, cheb.chebpts1, 0***REMOVED***

        #test points
        tgt = [0***REMOVED***
        assert_almost_equal(cheb.chebpts1(1***REMOVED***, tgt***REMOVED***
        tgt = [-0.70710678118654746, 0.70710678118654746***REMOVED***
        assert_almost_equal(cheb.chebpts1(2***REMOVED***, tgt***REMOVED***
        tgt = [-0.86602540378443871, 0, 0.86602540378443871***REMOVED***
        assert_almost_equal(cheb.chebpts1(3***REMOVED***, tgt***REMOVED***
        tgt = [-0.9238795325, -0.3826834323, 0.3826834323, 0.9238795325***REMOVED***
        assert_almost_equal(cheb.chebpts1(4***REMOVED***, tgt***REMOVED***

    def test_chebpts2(self***REMOVED***:
        #test exceptions
        assert_raises(ValueError, cheb.chebpts2, 1.5***REMOVED***
        assert_raises(ValueError, cheb.chebpts2, 1***REMOVED***

        #test points
        tgt = [-1, 1***REMOVED***
        assert_almost_equal(cheb.chebpts2(2***REMOVED***, tgt***REMOVED***
        tgt = [-1, 0, 1***REMOVED***
        assert_almost_equal(cheb.chebpts2(3***REMOVED***, tgt***REMOVED***
        tgt = [-1, -0.5, .5, 1***REMOVED***
        assert_almost_equal(cheb.chebpts2(4***REMOVED***, tgt***REMOVED***
        tgt = [-1.0, -0.707106781187, 0, 0.707106781187, 1.0***REMOVED***
        assert_almost_equal(cheb.chebpts2(5***REMOVED***, tgt***REMOVED***

if __name__ == "__main__":
    run_module_suite(***REMOVED***
