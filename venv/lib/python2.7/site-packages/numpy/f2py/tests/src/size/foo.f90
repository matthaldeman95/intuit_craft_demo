
subroutine foo(a, n, m, b***REMOVED***
  implicit none

  real, intent(in***REMOVED*** :: a(n, m***REMOVED***
  integer, intent(in***REMOVED*** :: n, m
  real, intent(out***REMOVED*** :: b(size(a, 1***REMOVED******REMOVED***

  integer :: i

  do i = 1, size(b***REMOVED***
    b(i***REMOVED*** = sum(a(i,:***REMOVED******REMOVED***
  enddo
end subroutine

subroutine trans(x,y***REMOVED***
  implicit none
  real, intent(in***REMOVED***, dimension(:,:***REMOVED*** :: x
  real, intent(out***REMOVED***, dimension( size(x,2***REMOVED***, size(x,1***REMOVED*** ***REMOVED*** :: y
  integer :: N, M, i, j
  N = size(x,1***REMOVED***
  M = size(x,2***REMOVED***
  DO i=1,N
     do j=1,M
        y(j,i***REMOVED*** = x(i,j***REMOVED***
     END DO
  END DO
end subroutine trans

subroutine flatten(x,y***REMOVED***
  implicit none
  real, intent(in***REMOVED***, dimension(:,:***REMOVED*** :: x
  real, intent(out***REMOVED***, dimension( size(x***REMOVED*** ***REMOVED*** :: y
  integer :: N, M, i, j, k
  N = size(x,1***REMOVED***
  M = size(x,2***REMOVED***
  k = 1
  DO i=1,N
     do j=1,M
        y(k***REMOVED*** = x(i,j***REMOVED***
        k = k + 1
     END DO
  END DO
end subroutine flatten
