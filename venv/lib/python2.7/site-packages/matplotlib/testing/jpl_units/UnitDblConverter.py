#===========================================================================
#
# UnitDblConverter
#
#===========================================================================


***REMOVED***UnitDblConverter module containing class UnitDblConverter.***REMOVED***

#===========================================================================
# Place all imports after here.
#
from __future__ import (absolute_import, division, print_function,
                        unicode_literals***REMOVED***

from matplotlib.externals import six

import numpy as np
import matplotlib.units as units
import matplotlib.ticker as ticker
import matplotlib.projections.polar as polar
from matplotlib.cbook import iterable
#
# Place all imports before here.
#===========================================================================

__all__ = [ 'UnitDblConverter' ***REMOVED***

#===========================================================================

# A special function for use with the matplotlib FuncFormatter class
# for formatting axes with radian units.
# This was copied from matplotlib example code.
def rad_fn(x, pos = None ***REMOVED***:
   ***REMOVED***Radian function formatter.***REMOVED***
   n = int((x / np.pi***REMOVED*** * 2.0 + 0.25***REMOVED***
   if n == 0:
      return str(x***REMOVED***
   elif n == 1:
      return r'$\pi/2$'
   elif n == 2:
      return r'$\pi$'
   elif n % 2 == 0:
      return r'$%s\pi$' % (n/2,***REMOVED***
   else:
      return r'$%s\pi/2$' % (n,***REMOVED***

#===========================================================================
class UnitDblConverter( units.ConversionInterface ***REMOVED***:
   ***REMOVED***: A matplotlib converter class.  Provides matplotlib conversion
        functionality for the Monte UnitDbl class.
   ***REMOVED***

   # default for plotting
   defaults = {
                 "distance" : 'km',
                 "angle" : 'deg',
                 "time" : 'sec',
          ***REMOVED***

   #------------------------------------------------------------------------
   @staticmethod
   def axisinfo( unit, axis ***REMOVED***:
      ***REMOVED***: Returns information on how to handle an axis that has Epoch data.

      = INPUT VARIABLES
      - unit    The units to use for a axis with Epoch data.

      = RETURN VALUE
      - Returns a matplotlib AxisInfo data structure that contains
        minor/major formatters, major/minor locators, and default
        label information.
      ***REMOVED***
      # Delay-load due to circular dependencies.
      import matplotlib.testing.jpl_units as U

      # Check to see if the value used for units is a string unit value
      # or an actual instance of a UnitDbl so that we can use the unit
      # value for the default axis label value.
      if ( unit ***REMOVED***:
         if ( isinstance( unit, six.string_types ***REMOVED*** ***REMOVED***:
            label = unit
         else:
            label = unit.label(***REMOVED***
      else:
         label = None

      if ( label == "deg" ***REMOVED*** and isinstance( axis.axes, polar.PolarAxes ***REMOVED***:
         # If we want degrees for a polar plot, use the PolarPlotFormatter
         majfmt = polar.PolarAxes.ThetaFormatter(***REMOVED***
      else:
         majfmt = U.UnitDblFormatter( useOffset = False ***REMOVED***

      return units.AxisInfo( majfmt = majfmt, label = label ***REMOVED***

   #------------------------------------------------------------------------
   @staticmethod
   def convert( value, unit, axis ***REMOVED***:
      ***REMOVED***: Convert value using unit to a float.  If value is a sequence, return
      the converted sequence.

      = INPUT VARIABLES
      - value   The value or list of values that need to be converted.
      - unit    The units to use for a axis with Epoch data.

      = RETURN VALUE
      - Returns the value parameter converted to floats.
      ***REMOVED***
      # Delay-load due to circular dependencies.
      import matplotlib.testing.jpl_units as U

      isNotUnitDbl = True

      if ( iterable(value***REMOVED*** and not isinstance(value, six.string_types***REMOVED*** ***REMOVED***:
         if ( len(value***REMOVED*** == 0 ***REMOVED***:
            return [***REMOVED***
         else:
            return [ UnitDblConverter.convert( x, unit, axis ***REMOVED*** for x in value ***REMOVED***

      # We need to check to see if the incoming value is actually a UnitDbl and
      # set a flag.  If we get an empty list, then just return an empty list.
      if ( isinstance(value, U.UnitDbl***REMOVED*** ***REMOVED***:
         isNotUnitDbl = False

      # If the incoming value behaves like a number, but is not a UnitDbl,
      # then just return it because we don't know how to convert it
      # (or it is already converted***REMOVED***
      if ( isNotUnitDbl and units.ConversionInterface.is_numlike( value ***REMOVED*** ***REMOVED***:
         return value

      # If no units were specified, then get the default units to use.
      if ( unit == None ***REMOVED***:
         unit = UnitDblConverter.default_units( value, axis ***REMOVED***

      # Convert the incoming UnitDbl value/values to float/floats
      if isinstance( axis.axes, polar.PolarAxes ***REMOVED*** and (value.type(***REMOVED*** == "angle"***REMOVED***:
         # Guarantee that units are radians for polar plots.
         return value.convert( "rad" ***REMOVED***

      return value.convert( unit ***REMOVED***

   #------------------------------------------------------------------------
   @staticmethod
   def default_units( value, axis ***REMOVED***:
      ***REMOVED***: Return the default unit for value, or None.

      = INPUT VARIABLES
      - value   The value or list of values that need units.

      = RETURN VALUE
      - Returns the default units to use for value.
      Return the default unit for value, or None.
      ***REMOVED***

      # Determine the default units based on the user preferences set for
      # default units when printing a UnitDbl.
      if ( iterable(value***REMOVED*** and not isinstance(value, six.string_types***REMOVED*** ***REMOVED***:
         return UnitDblConverter.default_units( value[0***REMOVED***, axis ***REMOVED***
      else:
         return UnitDblConverter.defaults[ value.type(***REMOVED*** ***REMOVED***
