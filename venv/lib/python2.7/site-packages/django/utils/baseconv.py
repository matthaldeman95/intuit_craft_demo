# Copyright (c***REMOVED*** 2010 Guilherme Gondim. All rights reserved.
# Copyright (c***REMOVED*** 2009 Simon Willison. All rights reserved.
# Copyright (c***REMOVED*** 2002 Drew Perttula. All rights reserved.
#
# License:
#   Python Software Foundation License version 2
#
# See the file "LICENSE" for terms & conditions for usage, and a DISCLAIMER OF
# ALL WARRANTIES.
#
# This Baseconv distribution contains no GNU General Public Licensed (GPLed***REMOVED***
# code so it may be used in proprietary projects just like prior ``baseconv``
# distributions.
#
# All trademarks referenced herein are property of their respective holders.
#

***REMOVED***
Convert numbers from base 10 integers to base X strings and back again.

Sample usage::

  >>> base20 = BaseConverter('0123456789abcdefghij'***REMOVED***
  >>> base20.encode(1234***REMOVED***
  '31e'
  >>> base20.decode('31e'***REMOVED***
  1234
  >>> base20.encode(-1234***REMOVED***
  '-31e'
  >>> base20.decode('-31e'***REMOVED***
  -1234
  >>> base11 = BaseConverter('0123456789-', sign='$'***REMOVED***
  >>> base11.encode('$1234'***REMOVED***
  '$-22'
  >>> base11.decode('$-22'***REMOVED***
  '$1234'

***REMOVED***

BASE2_ALPHABET = '01'
BASE16_ALPHABET = '0123456789ABCDEF'
BASE56_ALPHABET = '23456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz'
BASE36_ALPHABET = '0123456789abcdefghijklmnopqrstuvwxyz'
BASE62_ALPHABET = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'
BASE64_ALPHABET = BASE62_ALPHABET + '-_'


class BaseConverter(object***REMOVED***:
    decimal_digits = '0123456789'

    def __init__(self, digits, sign='-'***REMOVED***:
        self.sign = sign
        self.digits = digits
        if sign in self.digits:
            raise ValueError('Sign character found in converter base digits.'***REMOVED***

    def __repr__(self***REMOVED***:
        return "<BaseConverter: base%s (%s***REMOVED***>" % (len(self.digits***REMOVED***, self.digits***REMOVED***

    def encode(self, i***REMOVED***:
        neg, value = self.convert(i, self.decimal_digits, self.digits, '-'***REMOVED***
        if neg:
            return self.sign + value
        return value

    def decode(self, s***REMOVED***:
        neg, value = self.convert(s, self.digits, self.decimal_digits, self.sign***REMOVED***
        if neg:
            value = '-' + value
        return int(value***REMOVED***

    def convert(self, number, from_digits, to_digits, sign***REMOVED***:
        if str(number***REMOVED***[0***REMOVED*** == sign:
            number = str(number***REMOVED***[1:***REMOVED***
            neg = 1
        else:
            neg = 0

        # make an integer out of the number
        x = 0
        for digit in str(number***REMOVED***:
            x = x * len(from_digits***REMOVED*** + from_digits.index(digit***REMOVED***

        # create the result in base 'len(to_digits***REMOVED***'
        if x == 0:
            res = to_digits[0***REMOVED***
        else:
            res = ''
            while x > 0:
                digit = x % len(to_digits***REMOVED***
                res = to_digits[digit***REMOVED*** + res
                x = int(x // len(to_digits***REMOVED******REMOVED***
        return neg, res

base2 = BaseConverter(BASE2_ALPHABET***REMOVED***
base16 = BaseConverter(BASE16_ALPHABET***REMOVED***
base36 = BaseConverter(BASE36_ALPHABET***REMOVED***
base56 = BaseConverter(BASE56_ALPHABET***REMOVED***
base62 = BaseConverter(BASE62_ALPHABET***REMOVED***
base64 = BaseConverter(BASE64_ALPHABET, sign='$'***REMOVED***
