from django.conf import settings
from django.conf.urls import url
from django.urls import LocaleRegexURLResolver, get_resolver
from django.utils import lru_cache
from django.views.i18n import set_language


def i18n_patterns(*urls, **kwargs***REMOVED***:
    ***REMOVED***
    Adds the language code prefix to every URL pattern within this
    function. This may only be used in the root URLconf, not in an included
    URLconf.
    ***REMOVED***
    if not settings.USE_I18N:
        return list(urls***REMOVED***
    prefix_default_language = kwargs.pop('prefix_default_language', True***REMOVED***
    assert not kwargs, 'Unexpected kwargs for i18n_patterns(***REMOVED***: %s' % kwargs
    return [LocaleRegexURLResolver(list(urls***REMOVED***, prefix_default_language=prefix_default_language***REMOVED******REMOVED***


@lru_cache.lru_cache(maxsize=None***REMOVED***
def is_language_prefix_patterns_used(urlconf***REMOVED***:
    ***REMOVED***
    Return a tuple of two booleans: (
        `True` if LocaleRegexURLResolver` is used in the `urlconf`,
        `True` if the default language should be prefixed
    ***REMOVED***
    ***REMOVED***
    for url_pattern in get_resolver(urlconf***REMOVED***.url_patterns:
        if isinstance(url_pattern, LocaleRegexURLResolver***REMOVED***:
            return True, url_pattern.prefix_default_language
    return False, False


urlpatterns = [
    url(r'^setlang/$', set_language, name='set_language'***REMOVED***,
***REMOVED***
