from django.contrib.gis.geos.geometry import GEOSGeometry, hex_regex, wkt_regex
from django.utils import six


def fromfile(file_h***REMOVED***:
    ***REMOVED***
    Given a string file name, returns a GEOSGeometry. The file may contain WKB,
    WKT, or HEX.
    ***REMOVED***
    # If given a file name, get a real handle.
    if isinstance(file_h, six.string_types***REMOVED***:
        with open(file_h, 'rb'***REMOVED*** as file_h:
            buf = file_h.read(***REMOVED***
    else:
        buf = file_h.read(***REMOVED***

    # If we get WKB need to wrap in memoryview(***REMOVED***, so run through regexes.
    if isinstance(buf, bytes***REMOVED***:
        ***REMOVED***
            decoded = buf.decode(***REMOVED***
            if wkt_regex.match(decoded***REMOVED*** or hex_regex.match(decoded***REMOVED***:
                return GEOSGeometry(decoded***REMOVED***
        except UnicodeDecodeError:
            pass
    else:
        return GEOSGeometry(buf***REMOVED***

    return GEOSGeometry(six.memoryview(buf***REMOVED******REMOVED***


def fromstr(string, **kwargs***REMOVED***:
    "Given a string value, returns a GEOSGeometry object."
    return GEOSGeometry(string, **kwargs***REMOVED***
