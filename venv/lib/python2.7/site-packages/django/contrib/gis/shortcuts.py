import zipfile
from io import BytesIO

from django.conf import settings
from django.http import HttpResponse
from django.template import loader

# NumPy supported?
***REMOVED***
    import numpy
except ImportError:
    numpy = False


def compress_kml(kml***REMOVED***:
    "Returns compressed KMZ from the given KML string."
    kmz = BytesIO(***REMOVED***
    zf = zipfile.ZipFile(kmz, 'a', zipfile.ZIP_DEFLATED***REMOVED***
    zf.writestr('doc.kml', kml.encode(settings.DEFAULT_CHARSET***REMOVED******REMOVED***
    zf.close(***REMOVED***
    kmz.seek(0***REMOVED***
    return kmz.read(***REMOVED***


def render_to_kml(*args, **kwargs***REMOVED***:
    "Renders the response as KML (using the correct MIME type***REMOVED***."
    return HttpResponse(
        loader.render_to_string(*args, **kwargs***REMOVED***,
        content_type='application/vnd.google-earth.kml+xml',
    ***REMOVED***


def render_to_kmz(*args, **kwargs***REMOVED***:
    ***REMOVED***
    Compresses the KML content and returns as KMZ (using the correct
    MIME type***REMOVED***.
    ***REMOVED***
    return HttpResponse(
        compress_kml(loader.render_to_string(*args, **kwargs***REMOVED******REMOVED***,
        content_type='application/vnd.google-earth.kmz',
    ***REMOVED***


def render_to_text(*args, **kwargs***REMOVED***:
    "Renders the response using the MIME type for plain text."
    return HttpResponse(loader.render_to_string(*args, **kwargs***REMOVED***, content_type='text/plain'***REMOVED***
