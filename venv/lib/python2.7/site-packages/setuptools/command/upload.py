import getpass
from distutils.command import upload as orig


class upload(orig.upload***REMOVED***:
    ***REMOVED***
    Override default upload behavior to obtain password
    in a variety of different ways.
    ***REMOVED***

    def finalize_options(self***REMOVED***:
        orig.upload.finalize_options(self***REMOVED***
        # Attempt to obtain password. Short circuit evaluation at the first
        # sign of success.
        self.password = (
            self.password or
            self._load_password_from_keyring(***REMOVED*** or
            self._prompt_for_password(***REMOVED***
        ***REMOVED***

    def _load_password_from_keyring(self***REMOVED***:
        ***REMOVED***
        Attempt to load password from keyring. Suppress Exceptions.
        ***REMOVED***
        ***REMOVED***
            keyring = __import__('keyring'***REMOVED***
            return keyring.get_password(self.repository, self.username***REMOVED***
        except Exception:
            pass

    def _prompt_for_password(self***REMOVED***:
        ***REMOVED***
        Prompt for a password on the tty. Suppress Exceptions.
        ***REMOVED***
        ***REMOVED***
            return getpass.getpass(***REMOVED***
        except (Exception, KeyboardInterrupt***REMOVED***:
            pass
